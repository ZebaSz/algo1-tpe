\begin{problema}{crearS}{c: Campo, ds: [Drone]}{Sistema}
\requiere[idsUnicos] {(\forall i, j \in listaIds(ds)) \ i \neq j \implica listaIds(ds)_i \neq listaIds(ds)_j}
\requiere[dronesEnGranero] {(\forall d \in ds) \ \neg enVuelo(d) \wedge \ posicionActual(d) == posicionGranero(c)}
\requiere[bateriaLlena] {(\forall d \in ds) \ bateria(d) == 100}
\asegura[cultivosNoSensados] {(\forall i \in [0...prm (dimensiones(c))), \ j \leftarrow [0...sgd(dimensiones(c)))) \\ contenido (c,i,j) == Cultivo \implica estadoDelCultivo(\res,i,j) == NoSensado}
\asegura {campo (\res) == c}
\asegura[mismosDrones]{\longitud{ds} == \longitud{enjambreDrones(\res)} \wedge \ (\forall \ d1 \in ds) \ (\exists \ d2 \in enjambreDrones(\res)) \\ id(d1) == id(d2) \wedge mismoDrone(d1, d2)}
\end{problema}

\begin{problema}{campoS}{s: Sistema}{Campo}
\asegura {res == campo(s)}
\end{problema}

\begin{problema}{estadoDelCultivoS}{s: Sistema, i, j: \ent}{EstadoCultivo}
\requiere {enRango(dimensiones(campo(s)),i,j)}
\requiere {contenido(campo(s),i,j) == Cultivo}
\asegura {\res == estadoDelCultivo(s,i,j)}
\end{problema}

\begin{problema}{enjambreDronesS}{s: Sistema}{[Drone]}
\asegura {\longitud{enjambreDrones(s)} == \longitud{\res} \wedge \ (\forall \ d1 \in enjambreDrones(s)) \ (\exists \ d2 \in \res) \ mismoDrone(d1, d2)}
\end{problema}

\begin{problema}{crecerS}{s: Sistema}{}
\modifica {s}
\asegura[mismoCampo]{campo(\pre{s}) == campo(s)}
\asegura[mismosDrones]{\longitud{enjambreDrones(\pre{s})} == \longitud{enjambreDrones(s)} \wedge \ (\forall \ d1 \in enjambreDrones(\pre{s})) \\ (\exists \ d2 \in enjambreDrones(s)) \ mismoDrone(d1, d2)}
\asegura[crecimientoCultivo]{(\forall i \in [0..\prm{dimensiones(campo(s))})) (\forall j \in [0..\sgd{dimensiones(campo(s))})) \\ contenido(campo(s), i, j) == Cultivo \implica \\ (estadoDelCultivo(\pre{s}, i, j) == RecienSembrado \implica estadoDelCultivo(s, i, j) == EnCrecimiento \\ \wedge estadoDelCultivo(\pre{s}, i, j) == EnCrecimiento \implica estadoDelCultivo(s, i, j) == ListoParaCosechar \\ \wedge (estadoDelCultivo(\pre{s}, i, j) \neq RecienSembrado \wedge estadoDelCultivo(\pre{s}, i, j) \neq EnCrecimiento) \\ \implica estadoDelCultivo(\pre{s}, i, j)  = estadoDelCultivo(s, i, j))}
\end{problema}

\begin{problema}{seVinoLaMalezaS}{s: Sistema, ps: [(\ent, \ent)]}{}
\requiere {(\forall (i,j) \in ps) \ enRango(dimensiones(campo(s)),i,j)}
\requiere {(\forall (i,j) \in ps) \ contenido(campo(s),i,j) == Cultivo}
\modifica{s}
\asegura[mismoCampo]{campo(\pre{s}) == campo(s)}
\asegura[mismosDrones]{\longitud{enjambreDrones(\pre{s})} == \longitud{enjambreDrones(s)} \wedge \ (\forall \ d1 \in enjambreDrones(\pre{s})) \\ (\exists \ d2 \in enjambreDrones(s)) \ mismoDrone(d1, d2)}
\asegura[enmalezado]{(\forall i \in [0..\prm{dimensiones(campo(s))}) (\forall j \in [0..\sgd{dimensiones(campo(s))})) \\ \en{(i,j),ps} \implica estadoDelCultivo(s,i,j) == ConMaleza \\ \wedge \neg(\en{(i,j),ps)} \implica estadoDelCultivo(s,i,j) == estadoDelCultivo(pre(s),i,j)}
\end{problema}

\begin{problema}{seExpandePlagaS}{s: Sistema}{}
\modifica {s}
\asegura[mismoCampo]{campo(\pre{s}) == campo(s)}
\asegura[mismosDrones]{\longitud{enjambreDrones(\pre{s})} == \longitud{enjambreDrones(s)} \wedge \ (\forall \ d1 \in enjambreDrones(\pre{s})) \\ (\exists \ d2 \in enjambreDrones(s)) \ mismoDrone(d1, d2)}
\asegura[expansi√≥nDePlaga]{(\forall i \in [0..\prm{dimensiones(campo(s))}) (\forall j \in [0..\sgd{dimensiones(campo(s))}) \\ adyacenteAPlaga(s,i,j) \implica estadoDelCultivo(s,i,j) == ConPlaga \\ \wedge  \neg(adyacenteAPlaga(s,i,j)) \implica estadoDelCultivo(s,i,j) == estadoDelCultivo(pre(s),i,j)}
\end{problema}

\begin{problema}{despegarS}{s: Sistema, d: Drone}{}
\requiere{bateria(d) == 100}
\requiere{\neg enVuelo(d)}
\requiere{PosicionActual (d) == PosicionGranero (campo (s))}
\requiere{(\exists e \in enjambreDrones(s)) \ mismoDrone(d, e)}
\modifica{s}
\asegura[mismoCampo]{campo(\pre{s}) == campo(s)}
\asegura[mismoEstadoCultivo]{(\forall i \in [0..\prm{dimensiones(campo(s))})) (\forall j \in [0..\sgd{dimensiones(campo(s))})) \\ contenido(campo(s), i, j) \neq Cultivo \vee estadoDelCultivo(s,i,j) == estadoDelCultivo(\pre{s}, i, j))}
\asegura[losDronesEstan]{(\forall d1 \in enjambreDrones(\pre{s}), \ id(d1) \neq id(d)) \\ (\exists d2 \in enjambreDrones(s)) \ mismoDrone (d1, d2)}
\asegura[losDronesTienenQueEstar]{(\forall d2 \in enjambreDrones (s), \ id(d2) \neq id(d)) \\ (\exists d1 \in enjambreDrones(\pre{s})) \ mismoDrone (d1, d2)}
\asegura[elDroneDespega]{(\exists e \in enjambreDrones(s)) \ id(e) == id(d) \ \wedge posicionActual (e) == posicionActual (d) \\ \wedge \ bateria(e) == bateria (d) \ \wedge \ mismos(productosDisponibles(e), productosDisponibles(d)) \\ \wedge \ enVuelo(e) \ \wedge \ vueloRealizado(e) == [posicionActual]}
\end{problema}

\begin{problema}{listoParaCosecharS}{s: Sistema}{\bool}
\asegura{\res == (\longitud{[ 1 | (i,j) \leftarrow cultivos(s), estadoDelCultivo(s,i,j) == ListoParaCosechar ]} \div \longitud{cultivos(s)} \geq 0.9)}
\end{problema}

\begin{problema}{aterrizarYCargarBateriaS}{s: Sistema, b: \ent}{}
\requiere {0 < b \leq 100}
\modifica {s}
\asegura[mismoCampo]{campo(\pre{s}) == campo(s)}
\asegura[mismoEstadoCultivo]{(\forall i \in [0..\prm{dimensiones(campo(s))})) (\forall j \in [0..\sgd{dimensiones(campo(s))})) \\ contenido(campo(s), i, j) \neq Cultivo \vee estadoDelCultivo(s,i,j) == estadoDelCultivo(pre(s), i, j))}
\asegura[mismosDrones]{\longitud{enjambreDrones(s)} == \longitud{enjambreDrones(\pre{s})}}
\asegura[cambiosADrones]{(\forall d \in enjambreDrones(pre(s))) (\exists e \in enjambreDrones(s)) \\ (bateria(d) \leq b \implica (id(e) == id(d) \ \wedge \ bateria(e) == 100 \ \wedge \ \neg enVuelo(e) \\ \wedge \ posicionActual(e) == posicionGranero(campo(s))  \ \wedge \ vueloRealizado(d) == \lvacia \\ \wedge \ mismos(productosDisponibles(e),productosDisponibles(d)))) \\ \wedge (bateria(d) > b \implica mismoDrone(d,e))}
\end{problema}

\begin{problema}{fertilizarPorFilas}{s: Sistema}{}
\requiere[maxUnDronPorFila]{(\forall j \in [0..\sgd{dimension(campo(s))})) \\ \longitud{[ 1 | i \leftarrow [0..\prm{dimension(campo(s))}), \en{(i,j), posicionesDronesEnVuelo(s)} ]} < 2}
\modifica{s}
\asegura[mismoCampo]{campo(\pre{s}) == campo(s)}

\asegura[mismosDrones]{\longitud{enjambreDrones(s)} == \longitud{enjambreDrones(\pre{s})} \\ \wedge (\forall d \in enjambreDrones(\pre{s})) (\exists e \in enjambreDrones(s)) id(e) == id(d)}

\asegura[soloCambiarSiEnVuelo]{(\forall d \in enjambreDrones(\pre{s})) (\exists e \in enjambreDrones(s), id(e) == id(d)) \\ enVuelo(d) == enVuelo(e) \wedge \neg enVuelo(d) \implica mismoDrone (d,e)}

\asegura[vuelosAlOeste]{(\forall d \in enjambreDrones(\pre{s})) (\exists e \in enjambreDrones(s), id(e) == id(d)) \\ \prm{posicionActual(e)} == \prm{posicionActual(d)} - \longitud{vueloDiferente(e,d)}}

\asegura[gastoDeBateria]{(\forall d \in enjambreDrones(\pre{s})) (\exists e \in enjambreDrones(s), id(e) == id(d)) \\ bateria(e) == (bateria(d) + \longitud{vueloDiferente(e,d)})}

\asegura[unFertilizantePorCultivo]{(\forall d \in enjambreDrones(\pre{s})) (\exists e \in enjambreDrones(s), id(e) == id(d)) \\ mismos(productosDisponibles(d), productosDisponibles(e) ++ [ Fertilizante \ | \ i \leftarrow [0..\longitud{vueloDiferente(e,d)}) ])}

\asegura[soloCultivos]{(\forall d \in enjambreDrones(\pre{s})) (\exists e \in enjambreDrones(s), id(e) == id(d)) \\ (\forall (i,j) \in vueloDiferente(e,d)) contenido(campo(s),i,j) == Cultivo}

\asegura[condicionDeFinalizacion]{((\forall d \in enjambreDrones(s)) \\ bateria(d) == 0 \vee \neg(\en{Fertilizante, productosDisponibles(d)}) \\ \vee contenido(campo(s), \prm{vueloRealizado (d)_{|vueloRealizado(d)| - 1}}, \sgd{vueloRealizado (d)_{|vueloRealizado(d)| - 1}}) \neq Cultivo \ \vee \ \sgd{vueloRealizado (d)_{|vueloRealizado(d)| - 1}} == 0) \\ \implica vueloRealizado (d)_{|vueloRealizado(d)| - 1} == posicionActual (d)}

\asegura[fertilizarCampo]{(\forall d \in enjambreDrones(\pre{s})) \\ (\exists e \in enjambreDrones(s), id(e) == id(d)) (\forall (i,j) \in vueloDiferente(e,d)) \\ ((\en{estadoDelCultivo(\pre{s}, i, j), [RecienSembrado, EnCrecimiento]} \\ \implica estadoDelCultivo(s, i, j) == ListoParaCosechar) \\ \wedge (\neg \en{estadoDelCultivo(\pre{s}, i, j), [RecienSembrado, EnCrecimiento]} \\ \implica estadoDelCultivo(s, i, j) == estadoDelCultivo(\pre{s}, i, j))}

\end{problema}


\begin{problema}{volarYSensarS}{s: Sistema, d: Drone}{}
\requiere[puedeMoverse]{bateria(d) > 0}
\requiere {enVuelo (d)}
\requiere{(\exists e \in enjambreDrones(s)) mismoDrone(d, e)}

\modifica{s,d}

\asegura[mismoCampo]{campo(\pre{s}) == campo(s)}

\asegura[mismoEnjambre]{mismos(enjambreDrones(s), d : [ e \ | \ e \leftarrow enjambreDrones(\pre{s}), e \neq \pre{d} ])}

\asegura[mismoDron]{id(d) == id(\pre{d})}

\asegura[aParcelaAdyacente]{\longitud{vueloDiferente(d, pre(d))} == 1 \\ \wedge enRango(dimensiones(campo(s)), \prm{posicionActual(d)}, \sgd{posicionActual(d)})}

\asegura[sensado]{estadoDelCultivo(\pre{s}, \prm{posicionActual(d)}, \sgd{posicionActual(d)}) == NoSensado \implica (estadoDelCultivo(s, \prm{posicionActual(d)}, \sgd{posicionActual(d)}) \neq NoSensado \wedge noHaceNada(d, \pre{d})}

\asegura[siEstaBienNoHaceNada]{ \\ \neg \en{estadoDelCultivo(\pre{s}, \prm{posicionActual(d)}, \sgd{posicionActual(d)}), [ConMaleza, ConPlaga, NoSensado]} \\ \implica (noHaceNada(d, \pre{d}) \wedge estadoDelCultivo(\pre{s}, \prm{posicionActual(d)}, \sgd{posicionActual(d)}) == \\ == estadoDelCultivo(s, \prm{posicionActual(d)}, \sgd{posicionActual(d)}))}

\asegura[mataMalezas]{estadoDelCultivo(\pre{s}, \prm{posicionActual(d)}, \sgd{posicionActual(d)}) == ConMaleza \\ \implica (usaAlgunHerbicida(d, \pre{d}) \\ \wedge estadoDelCultivo(s, \prm{posicionActual(d)}, \sgd{posicionActual(d)}) == RecienSembrado) \\ \vee ((\neg tieneHerbicida(d) \vee bateria(\pre{d}) < 6) \\ \wedge noHaceNada(d, \pre{d}) \wedge estadoDelCultivo(s, \prm{posicionActual(d)}, \sgd{posicionActual(d)}) == ConMaleza))}

\asegura[mataPlagas]{estadoDelCultivo(\pre{s}, \prm{posicionActual(d)}, \sgd{posicionActual(d)}) == ConPlaga \\ \implica (usaPlaguicidaComun(d, \pre{d}) \\ \wedge estadoDelCultivo(s, \prm{posicionActual(d)}, \sgd{posicionActual(d)}) == RecienSembrado) \\ \vee (usaPlaguicidaBajoConsumo(d, \pre{d})  \\ \wedge estadoDelCultivo(s, \prm{posicionActual(d)}, \sgd{posicionActual(d)}) == RecienSembrado) \\ \vee ((tienePlaguicida(d) \wedge ((\neg tienePlaguicidaBajoConsumo (d) \wedge bateria (d) < 11) \vee (tienePlaguicidaBajoConsumo (d) \wedge bateria (d) < 6))) \vee  (\neg tienePlaguicida(d) \wedge \neg tienePlaguicidaBajoConsumo (d)))  \wedge noHaceNada(d, \pre{d}) \\ \wedge estadoDelCultivo(s, \prm{posicionActual(d)}, \sgd{posicionActual(d)}) == ConPlaga))}

\end{problema}
